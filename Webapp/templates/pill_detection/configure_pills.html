<!-- templates/pill_detection/configure_pills.html -->

{% extends 'base.html' %}

{% block title %}Configure Pills{% endblock %}

{% block content %}

    <h1>Configure {{ name }}</h1> 
    {% if name == 'Pills' %}
    <button class="rounded-input" onclick="openPopup()">Retrain Model</button>
    
    <div id="overlay" class="overlay">
        <div id="popup" class="popup">
            <div class="popup-content">
                <span class="close" onclick="closePopup()" style="font-size: 5vh;">&times;</span>
                <div style="padding-top: 2vh;">
                    <p>Are you sure you want to retrain the model? This process will take roughly 1.5 hours.</p>
                    <button class="rounded-input" onclick="confirmRetrain()">Yes, Retrain</button>
                </div>
                
            </div>
        </div>
    </div>
    {% endif %}

    <script>
        function openPopup() {
            document.getElementById("overlay").style.display = "block";
        }

        function closePopup() {
            document.getElementById("overlay").style.display = "none";
        }

        function confirmRetrain() {
            // Use Flask's url_for to generate the URL for the retrain_model route
            var retrainUrl = "{{ url_for('retrain_model') }}";
            
            // Redirect to the retrain_model route
            window.location.href = retrainUrl;
        }
    </script>

    <h2>Image Folders</h2>
    <div class="pill-detection-div configure-pills">
        {% for folder, images in image_data.items() %}
        <div style="margin-right: 3vh; display: flex; flex-direction: column; align-items: center;">
            <a href="{{ url_for('view_folder', folder=folder) }}" style="text-decoration: none; font-size: 20px; color: black;">
                <img src="{{ url_for('static', filename='images/folder_icon.png') }}" alt="Folder Icon" style="max-height: 100px; margin-bottom: 10px;">
            </a>
            <strong>{{ folder }}</strong>
            <!-- Delete button with confirmation -->
            <form action="{{ url_for('delete_folder', folder=folder) }}" method="post" onsubmit="return confirm('Are you sure you want to delete this folder and its contents?');">
                <button class="rounded-input" type="submit" style="margin-top: 10px;">Delete</button>
            </form>
            <hr class="horizontal-row-configure">
        </div>
        {% endfor %}
    </div>
{% endblock %}
